// =============================================
// OFICINA DE FIBRAS NATURAIS ‚Äî products.js
// Dados mock dos produtos (atualizado)
// Inclui: name, description, pricePerUnit,
//         stockQuantity, imageUrl, active
// =============================================

export const PRODUTOS = [
  {
    id: 1,
    nome: 'Suporte de Boneca Palha',
    description: 'Suporte artesanal confeccionado com fibras naturais de palha tran√ßada √† m√£o. Perfeito para decora√ß√£o de ambientes r√∫sticos e naturais. Cada pe√ßa √© √∫nica.',
    pricePerUnit: 85.00,
    precoAntigo: null,
    desconto: null,
    stockQuantity: 14,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 2,
    nome: 'Suporte de Boneca Cip√≥',
    description: 'Suporte de boneca produzido com cip√≥ seco e tiras de bambu, t√©cnica tradicional da Mata Atl√¢ntica. Produto sustent√°vel com acabamento natural.',
    pricePerUnit: 85.00,
    precoAntigo: 151.79,
    desconto: 44,
    stockQuantity: 7,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 3,
    nome: 'Suporte de Boneca Sisal',
    description: 'Escultura decorativa em sisal natural, colorido com tinturas vegetais. √ìtima op√ß√£o de presente artesanal ou item de decora√ß√£o aut√™ntico.',
    pricePerUnit: 85.00,
    precoAntigo: 151.79,
    desconto: 44,
    stockQuantity: 3,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 4,
    nome: 'Suporte de Boneca Juta',
    description: 'Boneca decorativa em juta crua, com enchimento de algod√£o org√¢nico e acabamento costurado √† m√£o. Hipoalerg√™nica e ecol√≥gica.',
    pricePerUnit: 85.00,
    precoAntigo: 151.79,
    desconto: 44,
    stockQuantity: 0,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: false,
    categoria: 'decoracao',
  },
  {
    id: 5,
    nome: 'Suporte de Boneca Buriti',
    description: 'Produto artesanal confeccionado com fibras de buriti, extra√≠das de forma sustent√°vel no cerrado brasileiro. Pe√ßa certificada pelo programa de artesanato sustent√°vel.',
    pricePerUnit: 85.00,
    precoAntigo: 151.79,
    desconto: 44,
    stockQuantity: 11,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 6,
    nome: 'Suporte de Boneca Taboa',
    description: 'Suporte produzido com folhas de taboa (Typha domingensis), planta aqu√°tica que cresce em rios e lagos. Lev√≠ssima, resistente e com textura √∫nica.',
    pricePerUnit: 85.00,
    precoAntigo: null,
    desconto: null,
    stockQuantity: 5,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 7,
    nome: 'Fatia de Laranja Desidratada',
    description: 'Decora√ß√£o artesanal com fatias de laranja lentamente desidratadas ao sol. Exala aroma c√≠trico suave e √© perfeita para arranjos natalinos, coroas e guirlandas.',
    pricePerUnit: 60.00,
    precoAntigo: 107.14,
    desconto: 44,
    stockQuantity: 22,
    imageUrl: null,
    emoji: 'üçä',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 8,
    nome: 'Fatia de Laranja com Cravo',
    description: 'Fatia de laranja desidratada com cravos-da-√≠ndia incrustados. Dupla fun√ß√£o: decora√ß√£o natural e aromatizador de ambientes. Aroma de especiarias por at√© 6 meses.',
    pricePerUnit: 60.00,
    precoAntigo: 107.14,
    desconto: 44,
    stockQuantity: 18,
    imageUrl: null,
    emoji: 'üçä',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 9,
    nome: 'Fatia de Laranja em Resina',
    description: 'Fatia de laranja preservada em resina ecol√≥gica biodegrad√°vel, montada em base de madeira maci√ßa. Pe√ßa decorativa permanente, n√£o apodrece nem resseca.',
    pricePerUnit: 60.00,
    precoAntigo: 107.14,
    desconto: 44,
    stockQuantity: 9,
    imageUrl: null,
    emoji: 'üçä',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 10,
    nome: 'Guirlanda C√≠trica Natural',
    description: 'Guirlanda com fatias de laranja, lim√£o e tangerina desidratadas, combinadas com folhas secas e fita de juta. Ideal para decora√ß√£o de portas e janelas.',
    pricePerUnit: 60.00,
    precoAntigo: 107.14,
    desconto: 44,
    stockQuantity: 0,
    imageUrl: null,
    emoji: 'üçä',
    active: false,
    categoria: 'decoracao',
  },
  {
    id: 11,
    nome: 'Suporte de Boneca Mimosa',
    description: 'Edi√ß√£o limitada com fibras de mimosa tingidas em corante natural de a√ßafr√£o-da-terra. Visual quente e textura aveludada. Apenas 20 unidades produzidas.',
    pricePerUnit: 85.00,
    precoAntigo: null,
    desconto: null,
    stockQuantity: 2,
    imageUrl: null,
    emoji: 'ü™Ü',
    active: true,
    categoria: 'decoracao',
  },
  {
    id: 12,
    nome: 'Mix C√≠trico Decorativo',
    description: 'Kit com 6 fatias sortidas de frutas c√≠tricas desidratadas: laranja, lim√£o-siciliano e bergamota. Embalagem presente√°vel em caixa kraft com la√ßo de sisal.',
    pricePerUnit: 60.00,
    precoAntigo: 107.14,
    desconto: 44,
    stockQuantity: 30,
    imageUrl: null,
    emoji: 'üçä',
    active: true,
    categoria: 'decoracao',
  },
];

// ============================
// Renderiza card de produto
// ============================
/**
 * Cria um <article> de produto pronto para o DOM.
 * Ao clicar, dispara o evento global 'produto:abrir' com os dados.
 */
export function criarCardProduto(produto) {
  const card = document.createElement('article');
  card.className = 'produto-card';
  card.setAttribute('aria-label', produto.nome);
  card.style.cursor = 'pointer';

  const temDesconto = produto.desconto && produto.precoAntigo;
  const semEstoque  = produto.stockQuantity === 0 || !produto.active;

  card.innerHTML = `
    ${temDesconto && produto.active ? `<span class="produto-card__badge">${produto.desconto}% OFF</span>` : ''}
    ${!produto.active ? `<span class="produto-card__badge" style="background:#C0392B;">Inativo</span>` : ''}
    ${produto.active && produto.stockQuantity === 0 ? `<span class="produto-card__badge" style="background:#888;">Esgotado</span>` : ''}

    <div class="produto-card__img" aria-hidden="true" style="font-size:48px;line-height:1;padding:20px 0;cursor:pointer;">
      ${produto.imageUrl
        ? `<img src="${produto.imageUrl}" alt="${produto.nome}" style="width:100%;height:100%;object-fit:cover;"/>`
        : produto.emoji}
    </div>

    <div class="produto-card__corpo">
      <p class="produto-card__nome">${produto.nome}</p>
      <div class="produto-card__precos">
        <span class="produto-card__preco-atual">R$ ${produto.pricePerUnit.toFixed(2).replace('.', ',')}</span>
        ${temDesconto
          ? `<span class="produto-card__preco-antigo">R$ ${produto.precoAntigo.toFixed(2).replace('.', ',')}</span>
             <span class="produto-card__preco-off">${produto.desconto}% off</span>`
          : ''}
      </div>
      <button
        class="produto-card__btn"
        data-id="${produto.id}"
        aria-label="Adicionar ${produto.nome} ao carrinho"
        ${semEstoque ? 'disabled style="background:var(--cinza-borda);cursor:not-allowed;"' : ''}
      >
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 001.95-1.52L23 6H6"/>
        </svg>
        ${semEstoque ? 'Indispon√≠vel' : 'Adicionar ao Carrinho'}
      </button>
    </div>
  `;

  // Clique na imagem ou nome ‚Üí abre modal de detalhe
  const abrirDetalhe = (e) => {
    if (e.target.closest('.produto-card__btn')) return; // deixa o bot√£o funcionar normalmente
    window.dispatchEvent(new CustomEvent('produto:abrir', { detail: produto }));
  };

  card.addEventListener('click', abrirDetalhe);

  return card;
}
